<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Enterprise Owner Panel</title>

<style>
body{
  margin:0;
  font-family:system-ui;
  background:#f1f5f9;
}
.header{
  background:#111827;
  color:#fff;
  padding:18px;
  font-size:22px;
  font-weight:900;
  text-align:center;
}
.container{
  max-width:1200px;
  margin:auto;
  padding:16px;
}
.card{
  background:#fff;
  padding:18px;
  border-radius:16px;
  margin-bottom:16px;
  box-shadow:0 4px 10px rgba(0,0,0,.05);
}
.grid{
  display:grid;
  grid-template-columns:repeat(auto-fit,minmax(200px,1fr));
  gap:12px;
}
.box{
  background:#f8fafc;
  padding:12px;
  border-radius:12px;
  font-weight:800;
}
.big{font-size:18px}
.red{color:#dc2626}
.green{color:#16a34a}
</style>
</head>

<body>

<div class="header">üè¢ Enterprise Owner Control Panel</div>

<div class="container">

<div class="card">
<h3>üü¢ Today Performance</h3>
<div class="grid">
<div class="box">Revenue ‚Çπ <span id="todayRevenue">0</span></div>
<div class="box">COGS ‚Çπ <span id="todayCOGS">0</span></div>
<div class="box green">Gross Profit ‚Çπ <span id="todayProfit">0</span></div>
<div class="box">Bills <span id="todayBills">0</span></div>
<div class="box">Avg Bill ‚Çπ <span id="avgBill">0</span></div>
<div class="box">Profit % <span id="profitPercent">0</span>%</div>
</div>
</div>

<div class="card">
<h3>üü° Month Overview</h3>
<div class="grid">
<div class="box">Revenue ‚Çπ <span id="monthRevenue">0</span></div>
<div class="box">COGS ‚Çπ <span id="monthCOGS">0</span></div>
<div class="box green">Gross ‚Çπ <span id="monthProfit">0</span></div>
<div class="box red">Expenses ‚Çπ <span id="monthExpense">0</span></div>
<div class="box">Net Real ‚Çπ <span id="monthNet">0</span></div>
</div>
</div>

<div class="card">
<h3>üîµ Inventory Intelligence</h3>
<div class="grid">
<div class="box">Stock Cost ‚Çπ <span id="inventoryCost">0</span></div>
<div class="box">Est Sell ‚Çπ <span id="inventorySell">0</span></div>
<div class="box green">Potential Profit ‚Çπ <span id="inventoryProfit">0</span></div>
</div>
</div>

<div class="card">
<h3>üî¥ Adjustments Insight</h3>
<div class="grid">
<div class="box">Positive Adj <span id="posAdj">0</span></div>
<div class="box">Negative Adj <span id="negAdj">0</span></div>
<div class="box red">Shrinkage ‚Çπ <span id="shrinkage">0</span></div>
</div>
</div>

</div>

<script type="module">

import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.0/firebase-app.js";
import { getFirestore, collection, getDocs } 
from "https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore.js";

initializeApp({
apiKey:"AIzaSyComVLxo36wvogoBFEoWyea-_yESW9BIPU",
authDomain:"anus-chicken-shop.firebaseapp.com",
projectId:"anus-chicken-shop"
});

const db=getFirestore();
const today=new Date().toISOString().slice(0,10);
const now=new Date();
const month=now.getMonth();
const year=now.getFullYear();

async function loadData(){

const sales=await getDocs(collection(db,"sales"));
const stock=await getDocs(collection(db,"stock_entries"));
const expenses=await getDocs(collection(db,"expenses"));
const adjustments=await getDocs(collection(db,"stock_adjustments"));

let todayRevenue=0, todayCOGS=0, todayBills=0;
let monthRevenue=0, monthCOGS=0;
let inventoryCost=0, inventorySell=0;
let monthExpense=0;
let pos=0,neg=0;

sales.forEach(d=>{
const s=d.data();
if(s.date===today){
todayRevenue+=s.total||0;
todayBills++;
}
if(new Date(s.date).getMonth()===month){
monthRevenue+=s.total||0;
}
});

stock.forEach(d=>{
const s=d.data();
if(s.remainingKg){
inventoryCost += s.remainingKg*(s.costPerSellableKg||0);
}
if(s.remainingQty){
inventoryCost += s.remainingQty*(s.costPerUnit||0);
}
});

expenses.forEach(d=>{
const e=d.data();
if(new Date(e.date).getMonth()===month){
monthExpense+=e.amount||0;
}
});

adjustments.forEach(d=>{
const a=d.data();
if(a.type==="positive") pos+=a.quantity||0;
if(a.type==="negative") neg+=a.quantity||0;
});

document.getElementById("todayRevenue").innerText=todayRevenue.toFixed(2);
document.getElementById("todayBills").innerText=todayBills;
document.getElementById("avgBill").innerText=
(todayBills? todayRevenue/todayBills:0).toFixed(2);

document.getElementById("monthRevenue").innerText=monthRevenue.toFixed(2);
document.getElementById("inventoryCost").innerText=inventoryCost.toFixed(2);
document.getElementById("monthExpense").innerText=monthExpense.toFixed(2);

document.getElementById("posAdj").innerText=pos.toFixed(2);
document.getElementById("negAdj").innerText=neg.toFixed(2);

}

loadData();

</script>

</body>
</html>
